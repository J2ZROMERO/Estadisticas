<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Viewer</title>

  
  <script src="/node_modules/pdfjs-dist/build/pdf.mjs" type="module"></script>





  <link rel="stylesheet" href="../assets/css/style.css" type="text/html">
  <style>

    .pdf-thumbnail {
        cursor: pointer;
        max-height: 78% !important;
        min-height: 78% !important;
      }
    
      .error-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #ff0000;
    color: #ffffff;
    padding: 10px 20px;
    border-radius: 5px;
    z-index: 9999;
    }
    
    
    .card-body{
    display: flex;
    justify-content: center;
    align-items: end;
    }
    
    
    .d-none {
    display: none;
    }
    
    
      .modal-body {
        height: calc(100% - 56px); /* Ensure modal body fills the available height (minus header height) */
      }
      .embed-responsive-16by9 {
        height: 90%; /* Ensure PDF iframe fills entire modal body height */
      }
      iframe {
        width: 100%;
        height: 100%;
      }
    
      /* Custom CSS for sticky footer */
      html,
      body {
        height: 100%;
      }
    
      .wrapper {
        display: flex;
        flex-direction: column;
      }
    
      .content {
        flex: 1;
      }
    
      .footer {
        flex-shrink: 0;
      }

      #pdfCanvasContainer {

      width: 100% !important; /* Set width to 50vh */
      height: 100% !important; /* Set height to 50vh */
      overflow-y: scroll; /* Enable vertical scrolling */
    }
    canvas {
      display: block;
      margin: 0 auto;
    }
    
    </style>
      

    
</head>
<body>

  
  

  
<div>
  <button id="prev">Previous</button>
  <button id="next">Next</button>
  &nbsp; &nbsp;
  <span>Page: <span id="page_num"></span> / <span id="page_count"></span></span>
</div>

<canvas id="the-canvas"></canvas>

  
  <!-- Comment form for PDF (initially hidden) -->
<div id="errorPopup" class="error-popup d-none">
  <span id="errorMessage"></span>
</div>


<canvas id="the-canvas"></canvas>


  <header class="p-3 mb-3 bg-danger text-white">
    <h1>PDF reading and comment.</h1>
  </header>
  
  
  
  <div class="container container d-flex justify-content-center mh-100vh">
    <div class="row justify-content-center mt-3">
      <div class="col-12">
        <div class="row row-cols-1 row-cols-md-3 g-3 mb-5">
         
          <!-- Starting cards elements-->
          <div class="col">
            <div class="card h-100 Aerodynamics">
              <img src="./resources/aerodinamicsBook.png" class="card-img-top pdf-thumbnail" alt="PDF Thumbnail" 
              data-bs-toggle="modal" data-bs-target="#pdfModal" data-pdf="./resources/pdfs/Aerodynamics.pdf">
              <div class="card-body">
                <h5 class="card-title">Author: Leonard Bairstow</h5>
              </div>
            </div>
          </div>
          
          
          <div class="col">
            <div class="card h-100 Cats">
              <img src="./resources/catsandpeople.png" 
              class="card-img-top pdf-thumbnail pdf2" alt="PDF Thumbnail" data-bs-toggle="modal" 
              data-bs-target="#pdfModal" data-pdf="./resources/pdfs/Cats.pdf">

              <div class="card-body">
                <h5 class="card-title">Author: Cats Protection</h5>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 colors">
              <img src="./resources/colors.png" 
              class="card-img-top pdf-thumbnail" alt="PDF Thumbnail" data-bs-toggle="modal" 
              data-bs-target="#pdfModal" data-pdf="./resources/pdfs/colors.pdf">

              <div class="card-body">
                <h5 class="card-title">Author: A. Hurlbert and Y. Ling</h5>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 rabbit">
              <img src="./resources/abit.png" 
              class="card-img-top pdf-thumbnail" alt="PDF Thumbnail" data-bs-toggle="modal" 
              data-bs-target="#pdfModal" data-pdf="./resources/pdfs/rabbit.pdf">

              <div class="card-body">
                <h5 class="card-title">Author: T. Albert-compressedT</h5>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 communism">
              <img src="./resources/communism.png" 
              class="card-img-top pdf-thumbnail" alt="PDF Thumbnail" data-bs-toggle="modal" 
              data-bs-target="#pdfModal" data-pdf="./resources/pdfs/communism.pdf">

              <div class="card-body">
                <h5 class="card-title">Author: Karl Marx,Fredrick Engels</h5>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100 pull-ups">
              <img src="./resources/pullups.png" 
              class="card-img-top pdf-thumbnail" alt="PDF Thumbnail" data-bs-toggle="modal" 
              data-bs-target="#pdfModal" data-pdf="./resources/pdfs/pull-ups.pdf">

              <div class="card-body">
                <h5 class="card-title">Author: Pullup & Dip</h5>
              </div>
            </div>
          </div>

          <!-- Ending cards elements-->
        </div>
      </div>
    </div>
  </div>

<div class="modal fade" id="pdfModal" tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">PDF Viewer</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="embed-responsive embed-responsive-16by9">
            <iframe class="embed-responsive-item" id="pdfViewer" src="" allowfullscreen></iframe>
            <!-- <div id="pdfViewer"  width="800" height="600"></div> -->
          </div>
          <!-- New section for comments -->
          <div class="mt-3">
            <h5>Comments</h5>
            <ul class="list-group" id="commentsList" dynamically added here -->
            </ul>
              <!-- Comments will be dynamically added here -->
          </div>
        </div>

  

<!-- Button to toggle comment form -->
<button type="button" class="btn btn-primary mt-3" id="toggleCommentForm">Add Comment</button>



<form class="modal-footer d-flex justify-content-center align-items-center d-none" id="commentForm">
  <div class="text-center col-12 col-sm-6">
    <div class="form-group text-start">
      <label for="name">Name:</label>
      <input type="text" class="form-control name-area" id="name" required>
    </div>
    <div class="form-group text-start">
      <label for="comment">Comment:</label>
      <textarea class="form-control comment-area" id="comment" rows="3" required></textarea>
    </div>
    <button type="submit" class="btn btn-primary mt-2">Submit</button>
  </div>
</form>

      </div>
    </div>
  </div>

  


  <!-- Sticky footer -->
  <footer class="footer fixed-bottom bg-light text-center py-1">
    <div class="container">
      <span class="text-muted">Made with Google Scripts and Node.js </span>
    </div>
  </footer>
 




<script type="module">
  // If absolute URL from the remote server is provided, configure the CORS
  // header on that server.
  var url = './resources/pdfs/Cats.pdf';

  // Loaded via <script> tag, create shortcut to access PDF.js exports.
  var { pdfjsLib } = globalThis;

  // The workerSrc property shall be specified.
  pdfjsLib.GlobalWorkerOptions.workerSrc = '../node_modules/pdfjs-dist/build/pdf.worker.mjs';

  var pdfDoc = null,
      pageNum = 1,
      pageRendering = false,
      pageNumPending = null,
      scale = 0.8,
      canvas = document.getElementById('the-canvas'),
      ctx = canvas.getContext('2d');

  /**
   * Get page info from document, resize canvas accordingly, and render page.
   * @param num Page number.
   */
  function renderPage(num) {
    pageRendering = true;
    // Using promise to fetch the page
    pdfDoc.getPage(num).then(function(page) {
      var viewport = page.getViewport({scale: scale});
      canvas.height = viewport.height;
      canvas.width = viewport.width;

      // Render PDF page into canvas context
      var renderContext = {
        canvasContext: ctx,
        viewport: viewport
      };
      var renderTask = page.render(renderContext);

      // Wait for rendering to finish
      renderTask.promise.then(function() {
        pageRendering = false;
        if (pageNumPending !== null) {
          // New page rendering is pending
          renderPage(pageNumPending);
          pageNumPending = null;
        }
      });
    });

    // Update page counters
    document.getElementById('page_num').textContent = num;
  }

  /**
   * If another page rendering in progress, waits until the rendering is
   * finised. Otherwise, executes rendering immediately.
   */
  function queueRenderPage(num) {
    if (pageRendering) {
      pageNumPending = num;
    } else {
      renderPage(num);
    }
  }

  /**
   * Displays previous page.
   */
  function onPrevPage() {
    if (pageNum <= 1) {
      return;
    }
    pageNum--;
    queueRenderPage(pageNum);
  }
  document.getElementById('prev').addEventListener('click', onPrevPage);

  /**
   * Displays next page.
   */
  function onNextPage() {
    if (pageNum >= pdfDoc.numPages) {
      return;
    }
    pageNum++;
    queueRenderPage(pageNum);
  }
  document.getElementById('next').addEventListener('click', onNextPage);

  /**
   * Asynchronously downloads PDF.
   */
  pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
    pdfDoc = pdfDoc_;
    document.getElementById('page_count').textContent = pdfDoc.numPages;

    // Initial/first page rendering
    renderPage(pageNum);
  });
</script>

<h1>PDF.js Previous/Next example</h1>



<div>
  <button id="prev">Previous</button>
  <button id="next">Next</button>
  &nbsp; &nbsp;
  <span>Page: <span id="page_num"></span> / <span id="page_count"></span></span>
</div>




  
  <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

  <script src="./js/index.js" type="module">  </script>
</body>
</html>
